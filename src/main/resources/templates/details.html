<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:shiro="http://www.pollix.at/thymeleaf/shiro">
<head>
    <meta charset="UTF-8">
    <title>查看提案</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="shortcut icon" href="../libs/images/favicon.ico">
    <link rel="stylesheet" type="text/css" href="../layui/css/layui.css">
    <link rel="stylesheet" type="text/css" href="../libs/css/style.css">
    <object id="LODOP_OB" classid="clsid:2105C259-1E0C-4534-8141-A753534CB4CA" width=0 height=0>
        <embed id="LODOP_EM" type="application/x-print-lodop" width=0 height=0></embed>
    </object>
    <style>
        .motion-table table {
            width: 800px;
        }
        .motion-table .tr_para td {
            padding: 15px!important;
        }
        @media print {
            .layui-btn {
                display: none;
            }
        }
    </style>
    <style media="print">
        @page {
            size: auto;  /* auto is the initial value */
            margin: 0mm; /* this affects the margin in the printer settings */
        }
    </style>
</head>
<body>
<div class="layui-fluid motion-table layui-form" lay-filter="seldetails" id="form1">
    <table border="1" id="print-text">
        <thead style="display:table-header-group;font-weight:bold">　
        </thead>
        <caption align="top">
            常宁政协第
            <span name="anniversary"></span>
            届
            <span name="number"></span>
            次会议<span name="proposalId" id="proposalId" th:text="${proposalId}" hidden="true"></span>
            <span name="proposalNumber"></span>
            号提案
        </caption>
        <tbody style="text-align: center">
        <tr>
            <td class="td20"><p>案  由</p><!--<span class="star">*</span>--></td>
            <td class="td80" colspan="3">&nbsp;<p name="cause"></p></td>
        </tr>
        <tr>
            <td class="td20"><p>通讯地址</p></td>
            <td class="td80" colspan="3">&nbsp;<p name="address"></p></td>
        </tr>
        <tr>
            <td class="td20"><p>提案者</p></td>
            <td class="td30">&nbsp;<p name="realName"></p></td>
            <td class="td20"><p>工作单位</p></td>
            <td class="td30">&nbsp;<p name="unitName"></p></td>
        </tr>
        <tr>
            <td class="td20"><p>邮  编</p></td>
            <td class="td30">&nbsp;<p name="postcode"></p></td>
            <td class="td20"><p>电子邮箱</p></td>
            <td class="td30">&nbsp;<p name="email"></p></td>
        </tr>
        <tr>
            <td class="td20"><p>界别</p></td>
            <td class="td30">&nbsp;<p name="subsector"></p></td>
            <td class="td20"><p>移动电话</p></td>
            <td class="td30">&nbsp;<p name="mobile"></p></td>
        </tr>
        <tr>
            <td class="td20"><p>提案类型</p></td>
            <td class="td30">&nbsp;<p name="type"></p></td>
            <td class="td20"><p>提案类别</p></td>
            <td class="td30">&nbsp;<p name="classify"></p></td>
        </tr>
        <tr>
            <td class="td20"><p>是否本人撰写</p></td>
            <td class="td30">&nbsp;<p name="isWrite"></p></td>
            <td class="td20"><p>是否经过调研</p></td>
            <td class="td30">&nbsp;<p name="isResearch"></p></td>
        </tr>
        <tr>
            <td class="td20"><p>是否参考提案选题</p></td>
            <td class="td30">&nbsp;<p name="isTopic"></p></td>
            <td class="td20"><p>是否转呈他人材料</p></td>
            <td class="td30">&nbsp;<p name="isMaterials"></p></td>
        </tr>
        <tr>
            <td class="td20"><p>联名人</p></td>
            <td class="td80" colspan="3">&nbsp;
                <p name="peoplestwo"></p>
            </td>
        </tr>
        <tr>
            <td class="td20"><p>主办单位</p></td>
            <td class="td80" colspan="3">&nbsp;<p name="zunits"></p></td>
        </tr>
        <tr>
            <td class="td20"><p>会办单位</p></td>
            <td class="td80" colspan="3">&nbsp;<p name="hunits"></p></td>
        </tr>
        <tr class="tr_bg">
            <td colspan="4"><p><strong>提案正文：</strong><strong> </strong></p></td>
        </tr>
        <tr class="tr_para">
            <td colspan="4">
                <p name="content" style="word-break: break-all"></p>
            </td>
        </tr>
        <tr class="tr_bg">
            <td colspan="4"><p><strong>提案办理详情：</strong><strong> </strong></p></td>
        </tr>
        <tr>
            <td class="td20 tdBlue"><p>提案创建时间</p></td>
            <td class="td80" colspan="3">&nbsp;<p name="createTime">0</p></td>
        </tr>
        <tr>
            <td class="td20 tdBlue"><p>办结时间</p></td>
            <td class="td80" colspan="3">&nbsp;<p name="endTime">0</p></td>
        </tr>
        <tr>
            <td class="td20 tdBlue"><p>提案附件</p></td>
            <td class="td80" colspan="3">
                <ul th:each="s,state:${JpmsAppendione}">
                    <li class="tdDiv tdBlue">
                        &nbsp;<a th:href="'../file/' + ${s.appendixId}" style="color: blue">[[${s.appendixName}]]</a>
                        <span class="date">[[${s.createTime}]]</span>
                    </li>
                </ul>
            </td>
        </tr>
        <tr>
            <td class="td20 tdBlue"><p>提案委意见</p></td>
            <td class="td80" colspan="3">
                <ul th:each="s,state:${JpmsAppendixtwo}">
                    <li class="tdDiv tdBlue">
                        &nbsp;<a th:href="'../file/' + ${s.appendixId}" style="color: blue">[[${s.appendixName}]]</a>
                        <span class="date">[[${s.createTime}]]</span>
                    </li>
                </ul>
            </td>
        </tr>
        <tr>
            <td class="td20 tdBlue"><p>两办意见</p></td>
            <td class="td80" colspan="3">
                <ul th:each="s,state:${two}">
                    <li class="tdDiv tdBlue">
                        &nbsp;<a th:href="'../file/' + ${s.appendixId}" style="color: blue">[[${s.appendixName}]]</a>
                        <span class="date">[[${s.createTime}]]</span>
                    </li>
                </ul>
            </td>
        </tr>
        <tr>
            <td class="td20 tdBlue"><p>主办意见</p></td>
            <td class="td80" colspan="3">
                <ul th:each="s,state:${JpmsAppendixz}">
                    <li class="tdDiv tdBlue">
                        <span style="color: red">办理单位：[[${s.unitName}]]</span><br>
                        <span style="color: #9F9F9F" shiro:hasPermission="after">之前办理类型：[[${s.answerAfter}]]</span><br>
                        办理类型： <span style="color: #9F9F9F">[[${s.answer}]]</span><br>
                        附件：<a th:href="'../file/' + ${s.appendixId}" style="color: blue">[[${s.appendixName}]]</a><br>
                        时间： <span class="date">[[${s.createTime}]]</span>
                    </li>
                </ul>
            </td>
        </tr>
        <tr>
            <td class="td20 tdBlue"><p>会办意见</p></td>
            <td class="td80" colspan="3">&nbsp;
                <ul th:each="s,state:${JpmsAppendixh}">
                    <li class="tdDiv tdBlue">
                        <span style="color: red">办理单位：[[${s.unitName}]]</span><br>
                        <span style="color: #9F9F9F" shiro:hasPermission="after">之前办理类型：[[${s.answerAfter}]]</span><br>
                        办理类型： <span style="color: #9F9F9F">[[${s.answer}]]</span><br>
                        附件：<a th:href="'../file/' + ${s.appendixId}" style="color: blue">[[${s.appendixName}]]</a><br>
                        时间： <span class="date">[[${s.createTime}]]</span>
                    </li>
                </ul>
            </td>
        </tr>
        <tr>
            <td class="td20 tdBlue"><p>满意度测评</p></td>
            <td class="td80" colspan="3">&nbsp;
                <p name="satisfaction"></p>&nbsp;
                <ul th:each="s,state:${JpmsAppendixthree}">
                    <li class="tdDiv tdBlue">
                        &nbsp;<a th:href="'../file/' + ${s.appendixId}" style="color: blue">[[${s.appendixName}]]</a>
                        <span class="date">[[${s.createTime}]]</span>
                    </li>
                </ul>
            </td>
        </tr>
        </tbody>
        <tfoot style="display:table-footer-group;font-weight:bold"></tfoot>
    </table>

</div>
<div class="text-c" style="margin-top: 30px;margin-bottom: 30px">
<!--    <a width="100%" height="20" id="isaz">查看本机是否安装(控件或web打印服务)</a>-->
    <input id="dayin" class="layui-btn layui-btn-red" type="button" value=" 打 印 预 览 ">
    <!--<input class="layui-btn layui-btn-red" type="button" value=" 打 印 预 览 " onclick="javascript: window.print();">-->
</div>

<script src="../layui/layui.js"></script>

<script src="../libs/lodop/LodopFuncs.js"></script>
<script>
    var cpath = "http://127.0.0.1:8888/";
    layui.use(["element", "form", "jquery"], function () {
        var $ = layui.jquery,
            form = layui.form,
            element = layui.element;


        $.ajax({
            url: "../parent/lookProposal/" + $("#proposalId").text(),
            type: "GET",
            data: {},
            dataType: "json",
            success: function (data) {
                form.val('seldetails', {})
                if(data.reserved == null){
                    $("[name=proposalNumber]").text(data.proposalNumber);//提案号
                }else{
                    $("[name=proposalNumber]").text(data.reserved+data.proposalNumber);//提案号
                }

                $("[name=cause]").text(data.cause);//案由
                $("[name=anniversary]").text(data.anniversary);//届
                $("[name=number]").text(data.number);//次
                $("[name=address]").text(data.juser.address);//通讯地址
                $("[name=content]").html(data.content);//内容
                $("[name=realName]").text(data.juser.realName);//提案者
                $("[name=unitName]").text(data.juser.unitName);//工作单位

                $("[name=email]").text(data.juser.email);//邮箱
                $("[name=subsector]").text(data.juser.subsector);//界别
                $("[name=mobile]").text(data.juser.mobile);//手机
                if (data.specifica == null) {
                    $("[name=type]").text(data.type);//类型
                } else {

                    $("[name=type]").text(data.type + "(" + data.specifica + ")");//类型
                }

                $("[name=classify]").text(data.classify);//类别
                if (data.isWrite == 1) {//是否本人撰写
                    $("[name=isWrite]").text("是");
                } else {
                    $("[name=isWrite]").text("否")
                }
                if (data.isResearch == 1) {//是否经过调研
                    $("[name=isResearch]").text("是");
                } else {
                    $("[name=isResearch]").text("否")
                }
                if (data.isTopic == 1) {//是否参考提案选题
                    $("[name=isTopic]").text("是");
                } else {
                    $("[name=isTopic]").text("否")
                }
                if (data.isMaterials == 1) {//是否转呈他人材料
                    $("[name=isMaterials]").text("是");
                } else {
                    $("[name=isMaterials]").text("否")
                }
                if (data.peoplesthree == null) {
                    $("[name=peoplestwo]").text("");
                } else {
                    $("[name=peoplestwo]").text(data.peoplesthree);//联名人
                }

                if (data.zunits == null) {
                    $("[name=zunits]").text("");//主办
                } else {
                    $("[name=zunits]").text(data.zunits);//主办
                }
                if (data.hunits == null) {
                    $("[name=hunits]").text("");//会办
                } else {
                    $("[name=hunits]").text(data.hunits);//会办
                }
                $("[name=postcode]").text(data.juser.postcode);//邮编
                if (data.juser.postcode == null) {
                    $("[name=postcode]").text("");
                } else {
                    $("[name=postcode]").text(data.juser.postcode);
                }
                $("[name=createTime]").text(data.createTime);//提案创建时间
                if (data.endTime == null) {
                    $("[name=endTime]").text("");
                } else {
                    $("[name=endTime]").text(data.endTime);//办结时间
                }
                if (data.satisfaction == null) {
                    $("[name=satisfaction]").text("");//满意度测评
                } else {
                    $("[name=satisfaction]").text(data.satisfaction);//满意度测评
                }
            }
        });
        //var LODOP=getLodop(document.getElementById('LODOP_OB'),document.getElementById('LODOP_EM'));
        var LODOP;

        $("#dayin").click(function () {
            //CreateOneFormPage();
            LODOP=getLodop();
            LODOP.PRINT_INIT("打印控件功能演示_Lodop功能_完整全页");
            LODOP.ADD_PRINT_HTM(10,10,'RightMargin:0.09cm','BottomMargin:7.1mm',"<body>"+document.getElementById("print-text").innerHTML + "</body>");
            LODOP.PREVIEW();
        });
        function CreateOneFormPage(){
            LODOP=getLodop();
            LODOP.PRINT_INIT("打印控件功能演示_Lodop功能_表单一");
            LODOP.SET_PRINT_STYLE("FontSize",18);
            LODOP.SET_PRINT_STYLE("Bold",1);
            LODOP.ADD_PRINT_TEXT(50,231,260,39,"打印页面部分内容");
            LODOP.ADD_PRINT_HTM(88,200,350,600,document.getElementById("form1").innerHTML);
        };

        $("#isaz").click(function () {
            try {
                var LODOP = getLodop();
                if (LODOP.VERSION) {
                    if (LODOP.CVERSION)
                        alert("当前有WEB打印服务C-Lodop可用!\n C-Lodop版本:" + LODOP.CVERSION + "(内含Lodop" + LODOP.VERSION + ")");
                    else
                        alert("本机已成功安装了Lodop控件！\n 版本号:" + LODOP.VERSION);

                }
                ;
            } catch (err) {
            }
        });
    });
</script>
</body>
</html>
